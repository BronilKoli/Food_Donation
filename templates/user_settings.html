{% extends "base.html" %}

{% block title %}User Settings{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <div class="bg-white dark:bg-dark-card rounded-lg shadow-md p-8 transition-colors duration-200">
        <h2 class="text-2xl font-bold text-gray-800 dark:text-white mb-6">
            <i class="fas fa-cog mr-2"></i>User Settings
        </h2>

        <form method="POST" class="space-y-6">
            {{ form.hidden_tag() }}
            
            <!-- Theme Preference -->
            <div>
                <label for="theme_preference" class="form-label">
                    <i class="fas fa-palette mr-2"></i>Theme Preference
                </label>
                <select id="theme_preference" name="theme_preference" class="form-input">
                    <option value="system" {% if current_user.theme_preference == 'system' %}selected{% endif %}>
                        System Preference
                    </option>
                    <option value="light" {% if current_user.theme_preference == 'light' %}selected{% endif %}>
                        Light Theme
                    </option>
                    <option value="dark" {% if current_user.theme_preference == 'dark' %}selected{% endif %}>
                        Dark Theme
                    </option>
                </select>
                <p class="form-help">
                    'System Preference' will follow your device's dark/light mode settings
                </p>
            </div>

            <!-- Account Information -->
            <div class="border-t dark:border-gray-700 pt-6">
                <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">
                    <i class="fas fa-user mr-2"></i>Account Information
                </h3>
                <div class="space-y-4">
                    <div>
                        <label for="name" class="form-label">Full Name</label>
                        <input type="text" id="name" name="name" 
                               value="{{ current_user.name }}"
                               class="form-input"
                               required>
                    </div>
                    <div>
                        <label for="email" class="form-label">Email Address</label>
                        <input type="email" id="email" name="email" 
                               value="{{ current_user.email }}"
                               class="form-input-disabled"
                               disabled>
                        <p class="form-help">Email address cannot be changed</p>
                    </div>
                </div>
            </div>

            <!-- Password Update -->
            <div class="border-t dark:border-gray-700 pt-6">
                <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">
                    <i class="fas fa-lock mr-2"></i>Update Password
                </h3>
                <div class="space-y-4">
                    <div>
                        <label for="current_password" class="form-label">Current Password</label>
                        <input type="password" id="current_password" name="current_password" 
                               class="form-input">
                    </div>
                    <div>
                        <label for="new_password" class="form-label">New Password</label>
                        <input type="password" id="new_password" name="new_password" 
                               class="form-input">
                        <p class="form-help">At least 8 characters with letters and numbers</p>
                    </div>
                    <div>
                        <label for="confirm_password" class="form-label">Confirm New Password</label>
                        <input type="password" id="confirm_password" name="confirm_password" 
                               class="form-input">
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex space-x-4 pt-6">
                <button type="submit" class="btn btn-primary flex-1">
                    <i class="fas fa-save mr-2"></i>Save Settings
                </button>
                <a href="{{ url_for('dashboard') }}" class="btn btn-secondary flex-1 text-center">
                    <i class="fas fa-times mr-2"></i>Cancel
                </a>
            </div>
        </form>
    </div>
</div>

<script>
document.getElementById('theme_preference').addEventListener('change', function() {
    const theme = this.value;
    if (theme === 'dark') {
        document.documentElement.classList.add('dark');
    } else if (theme === 'light') {
        document.documentElement.classList.remove('dark');
    } else {
        // Check system preference
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
    }
});
</script>
{% endblock %}